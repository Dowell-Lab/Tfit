<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>tfit-revisions: /home/mgohde/dworkspace/tfit-revisions/src/model_selection.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">tfit-revisions
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">Transcription fitter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('model__selection_8cpp.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">model_selection.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="model__selection_8h_source.html">model_selection.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="template__matching_8h_source.html">template_matching.h</a>&quot;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for model_selection.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="model__selection_8cpp__incl.png" border="0" usemap="#_2home_2mgohde_2dworkspace_2tfit-revisions_2src_2model__selection_8cpp" alt=""/></div>
<map name="_2home_2mgohde_2dworkspace_2tfit-revisions_2src_2model__selection_8cpp" id="_2home_2mgohde_2dworkspace_2tfit-revisions_2src_2model__selection_8cpp">
<area shape="rect" id="node2" href="model__selection_8h.html" title="model_selection.h" alt="" coords="254,259,381,285"/>
<area shape="rect" id="node16" href="template__matching_8h.html" title="template_matching.h" alt="" coords="521,109,663,136"/>
<area shape="rect" id="node4" href="load_8h.html" title="load.h" alt="" coords="558,333,615,360"/>
<area shape="rect" id="node7" href="read__in__parameters_8h.html" title="read_in_parameters.h" alt="" coords="741,408,888,435"/>
<area shape="rect" id="node11" href="_param_wrapper_8hpp.html" title="ParamWrapper.hpp" alt="" coords="98,408,233,435"/>
<area shape="rect" id="node18" href="_f_d_r_8h.html" title="FDR.h" alt="" coords="736,184,797,211"/>
<area shape="rect" id="node20" href="model_8h.html" title="model.h" alt="" coords="1041,259,1109,285"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9773ea50aa0d915fde1d7dcc712644ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__selection_8cpp.html#a9773ea50aa0d915fde1d7dcc712644ac">BIC</a> (double penalty, <a class="el" href="classsegment__fits.html">segment_fits</a> *S)</td></tr>
<tr class="separator:a9773ea50aa0d915fde1d7dcc712644ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6d35eb522748c069b3adeecf349b79a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__selection_8cpp.html#aa6d35eb522748c069b3adeecf349b79a">compute_true_and_false_positive_rates</a> (double penality, vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt; noise_fits, vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt; query_fits, double &amp;tp, double &amp;fp)</td></tr>
<tr class="separator:aa6d35eb522748c069b3adeecf349b79a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c13fe8438818b5ae0606ddda4feb626"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="model__selection_8cpp.html#a8c13fe8438818b5ae0606ddda4feb626">ROC</a> (vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt; noise_fits, vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt; query_fits, double &amp;AUC, double &amp;TP, double &amp;FP, double &amp;TP_at_fp, double &amp;FP_at_tp, double &amp;optimal_penality)</td></tr>
<tr class="separator:a8c13fe8438818b5ae0606ddda4feb626"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9773ea50aa0d915fde1d7dcc712644ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9773ea50aa0d915fde1d7dcc712644ac">&#9670;&nbsp;</a></span>BIC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int BIC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>penalty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classsegment__fits.html">segment_fits</a> *&#160;</td>
          <td class="paramname"><em>S</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines whether a set of <a class="el" href="classsegment__fits.html">segment_fits</a> is suitable for further processing.</p>
<p>More specifically, this function checks the inputs for invalid values (such as infinities, etc), then checks whether or not the BIC score of the given fit is better than simple random noise.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">penalty</td><td>Scales the model BIC calculation to set a sort of maximum score threshold. </td></tr>
    <tr><td class="paramname">S</td><td>Pointer to a segment fitting model. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Whether or not the given model is suitable. </dd></dl>

</div>
</div>
<a id="aa6d35eb522748c069b3adeecf349b79a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa6d35eb522748c069b3adeecf349b79a">&#9670;&nbsp;</a></span>compute_true_and_false_positive_rates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void compute_true_and_false_positive_rates </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>penality</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt;&#160;</td>
          <td class="paramname"><em>noise_fits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt;&#160;</td>
          <td class="paramname"><em>query_fits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>fp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Determines the error rates in calls generated by a given set of models.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">penality</td><td>(penalty?) Thresholding variable used to determine model suitability. </td></tr>
    <tr><td class="paramname">noise_fits</td><td>Set of models representing noise. </td></tr>
    <tr><td class="paramname">query_fits</td><td>Set of models to check. </td></tr>
    <tr><td class="paramname">tp</td><td>Double in which to store the number of true positives. </td></tr>
    <tr><td class="paramname">fp</td><td>Double in which to store the number of false positives. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8c13fe8438818b5ae0606ddda4feb626"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c13fe8438818b5ae0606ddda4feb626">&#9670;&nbsp;</a></span>ROC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ROC </td>
          <td>(</td>
          <td class="paramtype">vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt;&#160;</td>
          <td class="paramname"><em>noise_fits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="classsegment__fits.html">segment_fits</a> *&gt;&#160;</td>
          <td class="paramname"><em>query_fits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>AUC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>FP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>TP_at_fp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>FP_at_tp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>optimal_penality</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Computes the Receiver Operating Characteristic of the given models and noise. This determines whether or not a given model is better than chance when compared to a simple noise model.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">noise_fits</td><td>Set of noise models to compare query_fits against. </td></tr>
    <tr><td class="paramname">query_fits</td><td>Set of models to compare against noise_fits. </td></tr>
    <tr><td class="paramname">AUC</td><td>Double in which to store a score representing how accurately the models provided make calls. </td></tr>
    <tr><td class="paramname">TP</td><td>Double in which to store the true positive rate. </td></tr>
    <tr><td class="paramname">FP</td><td>Double in which to store the false positive rate. </td></tr>
    <tr><td class="paramname">TP_at_fp</td><td>Rate of true positives at min false positives. </td></tr>
    <tr><td class="paramname">FP_at_tp</td><td>Rate of false positives at min true positives. </td></tr>
    <tr><td class="paramname">optimal_density</td><td>Specifies the optimal model density at which the true positive rate is highest relative to the false positive rate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>No value is actually returned from this function. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="model__selection_8cpp.html">model_selection.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
